<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id-target="agent-management">
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <h1><i class="fa fa-home"></i> 代理授权 </h1>
            <ol class="breadcrumb">
                <li><a href="${path.concat('/dashboard')}">首页</a></li>
                <li><a data-toggle="collapse" data-parent="#accordion" href="#agent-management">代理管理</a></li>
                <li class="active">代理授权</li>
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">

           <form id="confirm_check_form">
                    <input type="hidden" name="agentId" value=${agent.agentId} />
           </form>
           <p>代理商姓名:&nbsp;&nbsp;
                <text>${agent.name}</text>
           </p>
          <p>联系方式:&nbsp;&nbsp;
                    <text>${agent.phone}</text>
          </p>
          <p>联系地址:&nbsp;&nbsp;
                    <text>${agent.address}</text>
          </p>
          <p>上级代理商:&nbsp;&nbsp;
              #if(!${agent.upperAgent})
                 <text>无</text>&nbsp;&nbsp;	
                 <div class="btn-group">
                   <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">
                      选择上级代理商 <span class="caret"></span>
                   </button>
                   <ul class="dropdown-menu" role="menu" style="height:200px;overflow:scroll">
                     #foreach( $elem in ${agentList})
                      <li><a id="$elem.agentId" onclick=select(this) data-toggle='modal' data-target='#set_upperAgent_modal'>$elem.name</a></li>
                     #end                    
                  </ul>
                </div>
              #else
                    <text>${agent.upperAgent.name}</text>
              #end
          </p>
          <p>群规模 :&nbsp;&nbsp;
              #if(${agent.claimScale}=="")
                 <text>未填</text>
              #else
                    <text>${agent.claimScale}</text>
              #end
          </p>
          <p>当前状态:&nbsp;&nbsp;
                    <text>未授权</text>
          </p>
        </div>
        #if(${credit}!="")
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <p>身份证正反面照片：</p>

                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <img src= ${path.concat('')}${credit.frontPath} class="img-rounded"
                         style="width:100%;">
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <img src= ${path.concat('')}${credit.backPath} class="img-rounded"
                         style="width:100%">
                </div>
            </div>
        #else
            <div class="col-md-12 col-lg-12">
                <p>当前用户没有上传身份证正反面照片</p>
            </div>
        #end
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <br>
            <button type="button" class="btn btn-primary" id="check_confirm">确认授权</button>
            <button type="button" class="btn btn-warning" data-toggle='modal' data-target='#agent_grant_modal'>审核不通过</button>
        </div>
    </div>
</div>
<div class="modal fade" id="agent_grant_modal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">x</button>
                <h4 class="modal-title">提示</h4>
            </div>
            <div class="modal-body">
               <p class="form-group">
                   审核不通过的代理商在登陆我们的系统时，会提示他们去修改自己的注册资料，然后重新提交注册信息，等待审核通过后才能登录 我们的系统！
               </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" id="confirm">确认</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="set_upperAgent_modal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">x</button>
                <h4 class="modal-title">提示</h4>
            </div>
            <div class="modal-body">
               <p class="form-group">
                  确定将该代理商设置为代理商${agent.name}的上级代理商？
               </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" id="set_confirm">确定</button>
            </div>
        </div>
    </div>
</div>
<script>

   $("#agent_grant_modal").modal({
            show: false,
            keyboard: true
   });
   
   $("#set_upperAgent_modal").modal({
       show: false,
       keyboard: true
   });


    $("#check_confirm").click(function () {
        $("#confirm_check_form").attr("action", "${path.concat('/agent/grant')}");
        $("#confirm_check_form").attr("method", "post");
        $("#confirm_check_form").submit();
    });
    
    $("#confirm").on('click', function () {

        var url = "${path.concat('/agent/grantNotPass/')}${agent.agentId}";
        window.location.href=url;
    });
    
    var upperAgentId;
    function select(obj){
    	upperAgentId=obj.id;
    }
    
    $("#set_confirm").on('click', function () {

        var url = "${path.concat('/agent/setUpperAgent/')}${agent.agentId}/"+upperAgentId;
        window.location.href=url;
    });
    

</script>