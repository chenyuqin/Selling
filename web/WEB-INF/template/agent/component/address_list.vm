<div id="address_modify" style="display: none;" >
	<div class="weui_cell">
	    <div class="weui_cell_bd weui_cell_primary">
	        <input id="address_modify_input" class="weui_input" type="text"/>
	    </div>
	</div>
	<div class="weui_btn_area">
		<button type="button" class="weui_btn weui_btn_primary" id="address_modify_confirm_btn">确认修改</button>
		<button type="button" class="weui_btn weui_btn_default" id="address_modify_history_btn">历史地址</button>
		<button type="button" class="weui_btn weui_btn_default" id="address_modify_cancel_btn">取消</button>
	</div>
</div>
<div id="actionSheet_wrap_address">
    <div class="weui_mask_transition" id="mask" style="display: none;"></div>
    <div class="weui_actionsheet" id="weui_actionsheet">
        <div class="weui_actionsheet_menu">
            <div class="weui_actionsheet_cell" id="actionsheet_1">1</div>
            <div class="weui_actionsheet_cell" id="actionsheet_2">2</div>
            <div class="weui_actionsheet_cell" id="actionsheet_3">3</div>
            <div class="weui_actionsheet_cell" id="actionsheet_4">4</div>
            <div class="weui_actionsheet_cell" id="actionsheet_5">5</div>
        </div>
        <div class="weui_actionsheet_action">
            <div class="weui_actionsheet_cell" id="actionsheet_cancel">其他</div>
        </div>
    </div>
</div>
<script>
	$.show_address_modify = function(){
		$("#address_modify").fadeIn();
		$("#address_modify_input").val($(address_dom).data("address"));
	}
	$("#address_modify_confirm_btn").on("click",function(){
		var new_address = $("#address_modify_input").val();
		var customerId = $(address_dom).data("customerId");
		var url = "${path.concat('/customer/modifyAddress/')}" + customerId;
		var post_data = {address: new_address};
		$.post(url, post_data, function(result){
			console.debug(result);
			if(result.responseCode == "RESPONSE_OK"){
				$(address_dom).data("address",new_address);
				$(address_dom).find(".address").html($.addressBeautify(new_address));
			}
			$("#addres_modify").hide();
			$("#place_order_panel").fadeIn();
		});
	});
	
	$("#address_modify_history_btn").on("click",function(){
		var customerId = $(address_dom).data("customerId");
		var url = "${path.concat('/customer/address/')}" + customerId;
		$.getJSON(url,function(data){
			console.debug(data);
		});
	});
	
	$("#address_modify_cancel_btn").on("click",function(){
		$("#address_modify").hide();
		$("#place_order_panel").fadeIn();
	});
	//弹数量sheet
    $.toggleAddressModifySheet = function(){
   		var mask = $('#mask');
            var weuiActionsheet = $('#weui_actionsheet_address');
            weuiActionsheet.addClass('weui_actionsheet_toggle');
            mask.show()
                .focus()//加focus是为了触发一次页面的重排(reflow or layout thrashing),使mask的transition动画得以正常触发
                .addClass('weui_fade_toggle').one('click', function () {
                hideActionSheet(weuiActionsheet, mask);
            });
            $('#actionsheet_1').one('click',function(){
            	$('#num_input').val(1);
            	hideActionSheet(weuiActionsheet, mask);
            });
            $('#actionsheet_2').one('click',function(){
            	$('#num_input').val(2);
            	hideActionSheet(weuiActionsheet, mask);
            });
            $('#actionsheet_3').one('click',function(){
            	$('#num_input').val(3);
            	hideActionSheet(weuiActionsheet, mask);
            });
            $('#actionsheet_4').one('click',function(){
            	$('#num_input').val(4);
            	hideActionSheet(weuiActionsheet, mask);
            });
            $('#actionsheet_cancel').one('click', function () {
                hideActionSheet(weuiActionsheet, mask);
                $('#num_input').removeAttr('readonly');
                $("#num_input").unbind("focusin",$.toggleNumModifySheet);
                $("#num_input").focus();
            });
            mask.unbind('transitionend').unbind('webkitTransitionEnd');

            function hideActionSheet(weuiActionsheet, mask) {
                weuiActionsheet.removeClass('weui_actionsheet_toggle');
                mask.removeClass('weui_fade_toggle');
                mask.on('transitionend', function () {
                    mask.hide();
                }).on('webkitTransitionEnd', function () {
                    mask.hide();
                })
            }
    }
</script>