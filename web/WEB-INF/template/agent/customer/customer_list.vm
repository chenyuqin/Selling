<div class="panel" id="customer_list_panel">
    <div id="customer_panel">
        <div class="hd">
            <h1 class="page_title">我的客户</h1>

            <p class="page_desc">管理客户信息</p>

        </div>
        <div class="bd">
            <div class="bd spacing">
                <button id="add_customer_btn" class="weui_btn weui_btn_plain_primary">新增客户</a>
            </div>
            <div class="weui_panel">
                <div class="list-cell">
                    <div class="weui_cells weui_cells_access" id="customer_list" style="margin-top:0;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    #parse("/agent/component/add_customer.vm")
    #parse("/agent/component/update_customer.vm")
</div>
<script>
    $("#add_customer_form").hide();
    $("#add_customer_btn").click(function () {
        $("#add_customer_form").fadeIn();
        $("#customer_panel").hide();
    });
    window.onload = function () {
        var url = "${path.concat('/agent/customer/list')}";
        $.post(url, function (result) {
          if('responseCode' in result){      
        	if(result.description == "您需要重新登录 "){
        		window.location="${path.concat('/agent/login')}";
        		return;
        	}
            var list = result.data;
            for (var i = 0; i < list.length; i++) {
                var item = list[i];
                var node = "<a class='weui_cell customer' onclick='updateCustomer(this)' id='" + item.customerId + "' ><div class='weui_cell_bd weui_cell_primary'><p>" + item.name + "</p></div><div class='weui_cell_ft'>" + item.phone.phone + "</div></a>";
                $("#customer_list").append(node);
            }
          }
        });
    };
</script>
